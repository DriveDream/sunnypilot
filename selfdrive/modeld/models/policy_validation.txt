Checking for empty initializers in model1:
Checking for empty initializers in model2:
--------------------------------------------------
Model 1 checkpoint: merged_onnx_heads_keep with w=0.5 from (model1: 'merged_onnx_heads_keep with w=0.5 from (model1: 'a423dec7-7dcc-4523-aaae-a4012d56b9b5/400') and (model2: 'aac83a2b-ad88-4df6-bf60-a1f137ec09da/400')') and (model2: '30bba5b8-1269-45b2-8e53-672ce1f38623/400')
Model 2 checkpoint: ead798b9-f2c3-40c1-8918-73a4b0d832c9/400
Base model: driving_policy.onnx
--------------------------------------------------
Found 63 common weights to merge.
Found 0 weights only in the base model (will be kept).
Found 0 weights only in the second model.
Model 1 only weights: []
Model 2 only weights: []
Common weights: ['onnx::Add_221', 'onnx::MatMul_222', 'onnx::MatMul_223', 'onnx::MatMul_238', 'onnx::MatMul_239', 'onnx::MatMul_240', 'pad', 'policy_model.action_block.action_block_in.0.bias', 'policy_model.action_block.action_block_in.0.weight', 'policy_model.action_block.action_block_out.bias']...
--------------------------------------------------
Model 1 ONNX head weights (auto-generated): []
Model 2 ONNX head weights (auto-generated): []
head pattern: ['policy_model']
  ONNX Model 1 head weights (will be kept): 0 ([])
  ONNX Model 2 head weights (will be ignored): 0 ([])
  Note: auto-generated head weights will not be updated
--------------------------------------------------
Updating model checkpoint to: 'merged_onnx_heads_keep with w=0.5 from (model1: 'merged_onnx_heads_keep with w=0.5 from (model1: 'merged_onnx_heads_keep with w=0.5 from (model1: 'a423dec7-7dcc-4523-aaae-a4012d56b9b5/400') and (model2: 'aac83a2b-ad88-4df6-bf60-a1f137ec09da/400')') and (model2: '30bba5b8-1269-45b2-8e53-672ce1f38623/400')') and (model2: 'ead798b9-f2c3-40c1-8918-73a4b0d832c9/400')'
--------------------------------------------------
MERGE SUMMARY:
  Removed 0 head initializers: []
  Added 0 head initializers: []
  Replaced 0 outputs: []
  Merged 63 common trunk weights (weight=0.5)
  Kept 0 ONNX head weights from model1: []
  Ignored 0 ONNX head weights from model2: []
  Behavior: Using model1's driving patterns with merged trunk features
--------------------------------------------------
MODEL EVALUATION
--------------------------------------------------
1. ONNX Structure Validation:
    ONNX structure is consistent

2. Model Metadata Validation:
   IR Version: 8
   Opset Version: [17]
   Producer: pytorch 2.7.1

3. Graph Structure Validation:
   Nodes: 107
   Inputs: 5
   Outputs: 1
   Initializers: 63
   Original nodes: 107 -> Merged: 107
   Original initializers: 63 -> Merged: 63

4. Input/Output Shape Validation:
   Input 0: desire -> [1, 25, 8] (10)
   Input 1: traffic_convention -> [1, 2] (10)
   Input 2: lateral_control_params -> [1, 2] (10)
   Input 3: prev_desired_curv -> [1, 25, 1] (10)
   Input 4: features_buffer -> [1, 25, 512] (10)
   Output 0: outputs -> [1, 4968] (10)

5. Weight Validation:
 Potential weight issues found:
     - pad: Zero variance (might be frozen)
   policy_model.temporal_summarizer.transformer.0.mlp.layer_norm.weight: shape=(512,), mean=0.493896, std=0.171265
   policy_model.temporal_hydra.res_layer.desire_state.0.weight: shape=(32, 32), mean=0.009087, std=0.153198
   onnx::MatMul_239: shape=(512, 2048), mean=0.000355, std=0.035797
   policy_model.temporal_hydra.final_layer.desire_state.bias: shape=(8,), mean=-0.063477, std=0.190796
   policy_model.temporal_hydra.res_layer.plan.0.bias: shape=(256,), mean=-0.011391, std=0.065796
   policy_model.action_block.resblocks.1.block_b.1.weight: shape=(512, 128), mean=0.001601, std=0.030075
   policy_model.temporal_hydra.res_layer.plan.0.weight: shape=(256, 256), mean=-0.006470, std=0.051971
   policy_model.temporal_hydra.resblock.block_a.0.weight: shape=(1024, 512), mean=0.000066, std=0.014214
   policy_model.temporal_summarizer.transformer.0.attn.layer_norm.bias: shape=(512,), mean=0.006039, std=0.095520
   policy_model.temporal_hydra.resblock.block_a.3.weight: shape=(512, 1024), mean=-0.000421, std=0.019867

6. Node Connectivity Validation:
All node inputs are satisfied

7. Inference Capability Test:
    Model can be loaded by ONNX Runtime
   Input: desire -> [1, 25, 8] (tensor(float16))
   Input: traffic_convention -> [1, 2] (tensor(float16))
   Input: lateral_control_params -> [1, 2] (tensor(float16))
   Input: prev_desired_curv -> [1, 25, 1] (tensor(float16))
   Input: features_buffer -> [1, 25, 512] (tensor(float16))

8. Model Size Analysis:
   Original model: 14.86167145 MB
   Merged model: 14.86177444 MB
   Size change: +0.00069304%


